webpackJsonp([1],{"+HYU":function(t,e){},"1fqm":function(t,e){},MH9I:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("O694");var a=s("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view"),this._v(" "),this._m(0)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-footer"},[e("p",{staticClass:"weui-footer__text"},[this._v("Copyright © 2018")])])}]};var n=s("VU/8")({name:"App"},i,!1,function(t){s("+HYU")},null,null).exports,l=s("/ocq"),o={name:"HelloWorld",data:function(){return{token:"",ws:null,newMsg:"",chatContent:"",email:null,username:null,joined:!1,list:[],total:0}},watch:{list:function(t){for(var e=0,s=0;s<this.list.length;s++){var a=parseFloat(this.list[s].amount);a&&(e+=a)}this.total=Math.floor(100*e)/100}},mounted:function(){this.token=this.$route.query.token,console.log(this.token)},created:function(){var t=this;t.axios.get("http://119.23.237.215:3344/list").then(function(e){for(var s in e.data){var a=e.data[s],i=Math.floor(100*a.amount)/100;t.list.push({id:a.id,name:a.name,amount:i})}}),t.ws=new WebSocket("ws://119.23.237.215:3344/ws"),t.ws.addEventListener("message",function(e){var s=JSON.parse(e.data);if("donate"==s.type){var a=Math.floor(100*s.amount)/100;t.list.push({id:s.id,name:s.name,amount:a})}})},methods:{}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._m(0),t._v(" "),a("img",{staticStyle:{"max-width":"100%"},attrs:{src:s("u1NA")}}),t._v(" "),a("div",{staticClass:"page__hd"},[a("p",{staticClass:"page__desc"},[t._v("捐款人次："+t._s(t.list.length))]),t._v(" "),a("p",{staticClass:"page__desc"},[t._v("捐款总金额："+t._s(t.total)+" 元")]),t._v(" "),a("p",{staticClass:"page__desc"},[t._v("排名不分先后，本名单实时更新！")])]),t._v(" "),a("div",{staticClass:"weui-cells"},t._l(t.list,function(e){return a("div",{key:e.id,staticClass:"weui-cell"},[a("div",{staticClass:"weui-cell__bd"},[a("p",[t._v(t._s(e.name))])]),t._v(" "),a("div",{staticClass:"weui-cell__ft"},[t._v(t._s(e.amount)+" 元")])])}))])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page__hd"},[e("h1",{staticClass:"page__title"},[this._v("“迎春送福•领墨宝献爱心”活动捐款清单")])])}]};var c=s("VU/8")(o,u,!1,function(t){s("MH9I")},"data-v-c1823b1e",null).exports,r=s("bOdI"),v=s.n(r),_={name:"HelloWorld",data:function(){return v()({showpanel:1,inputToken:"",inputName:"",inputAmount:null,msg:"",token:"",ws:null,newMsg:"",chatContent:"",email:null,username:null,joined:!1,list:[],total:0,showMsg:!1},"msg","")},watch:{list:function(t){for(var e=0,s=0;s<this.list.length;s++){var a=parseFloat(this.list[s].amount);a&&(e+=Math.floor(100*a)/100)}this.total=Math.floor(100*e)/100}},mounted:function(){this.token=this.$route.query.token},created:function(){var t=this;t.axios.get("http://119.23.237.215:3344/list").then(function(e){for(var s in e.data){var a=e.data[s],i=Math.floor(100*a.amount)/100;t.list.push({id:a.id,name:a.name,amount:i})}}),t.ws=new WebSocket("ws://119.23.237.215:3344/ws"),t.ws.addEventListener("message",function(e){var s=JSON.parse(e.data);if("donate"==s.type){var a=Math.floor(100*s.amount)/100;t.list.push({id:s.id,name:s.name,amount:a})}})},methods:{saveToken:function(){this.token=this.inputToken},pushMsg:function(){this.token=this.inputToken},pushDonate:function(){var t=this;if(""==t.inputName)return!1;if(""==t.inputAmount)return!1;var e="http://119.23.237.215:3344/api?type=donate&name="+t.inputName+"&amount="+parseFloat(t.inputAmount)+"&token="+t.token;t.axios.get(e).then(function(e){t.inputName="",t.inputAmount="",console.log(e.data),t.msg="已增加捐款记录",t.showMsg=!0,setTimeout(function(){t.showMsg=!1},1500)})}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.showMsg?s("div",{attrs:{id:"toast"}},[s("div",{staticClass:"weui-mask_transparent"}),t._v(" "),s("div",{staticClass:"weui-toast"},[s("i",{staticClass:"weui-icon-success-no-circle weui-icon_toast"}),t._v(" "),s("p",{staticClass:"weui-toast__content"},[t._v(t._s(t.msg))])])]):t._e(),t._v(" "),s("div",{staticClass:"page__hd"},[s("h1",{staticClass:"page__title"},[t._v("捐赠人名单管理后台")]),t._v(" "),s("p",{staticClass:"page__desc"},[t._v("排名不分先后，本名单实时更新！")]),t._v(" "),s("p",{staticClass:"page__desc"},[t._v("捐款人次："+t._s(t.list.length))]),t._v(" "),s("p",{staticClass:"page__desc"},[t._v("捐款总金额："+t._s(t.total))])]),t._v(" "),t.token?s("div",[s("div",{staticClass:"weui-tab"},[s("div",{staticClass:"weui-navbar"},[s("div",{staticClass:"weui-navbar__item",class:1==t.showpanel?"weui-bar__item_on":"",on:{click:function(e){t.showpanel=1}}},[t._v("\n                    新增捐款\n                ")]),t._v(" "),s("div",{staticClass:"weui-navbar__item",class:2==t.showpanel?"weui-bar__item_on":"",on:{click:function(e){t.showpanel=2}}},[t._v("\n                    捐款记录\n                ")])]),t._v(" "),s("div",{staticClass:"weui-tab__panel"},[1==t.showpanel?s("div",[s("div",{staticClass:"weui-cells__title"},[t._v("发布新捐款信息")]),t._v(" "),s("div",{staticClass:"weui-cells"},[s("div",{staticClass:"weui-cell"},[s("div",{staticClass:"weui-cell weui-cell_select weui-cell_select-before"},[s("div",{staticClass:"weui-cell__hd"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputName,expression:"inputName"}],staticClass:"weui-input",attrs:{placeholder:"捐款人"},domProps:{value:t.inputName},on:{input:function(e){e.target.composing||(t.inputName=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"weui-cell__bd"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputAmount,expression:"inputAmount"}],staticClass:"weui-input",attrs:{type:"number",pattern:"[0-9]*",placeholder:"金额"},domProps:{value:t.inputAmount},on:{input:function(e){e.target.composing||(t.inputAmount=e.target.value)}}})])])])]),t._v(" "),s("div",{staticClass:"weui-btn-area"},[s("a",{staticClass:"weui-btn weui-btn_primary",attrs:{href:"javascript:"},on:{click:t.pushDonate}},[t._v("提交捐款消息")])])]):t._e(),t._v(" "),2==t.showpanel?s("div",[t.list.length>0?s("div",{staticClass:"weui-cells"},t._l(t.list,function(e){return s("div",{key:e.id,staticClass:"weui-cell"},[s("div",{staticClass:"weui-cell__bd"},[s("p",[t._v(t._s(e.name))])]),t._v(" "),s("div",{staticClass:"weui-cell__ft"},[t._v(t._s(e.amount)+" 元")])])})):t._e(),t._v(" "),t.list.length<1?s("div",{staticClass:"weui-cells"},[t._m(0)]):t._e()]):t._e()])])]):t._e(),t._v(" "),t.token?t._e():s("div",[s("div",{staticClass:"weui-cells__title"},[t._v("安全验证")]),t._v(" "),s("div",{staticClass:"weui-cells"},[s("div",{staticClass:"weui-cell"},[s("div",{staticClass:"weui-cell__bd"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputToken,expression:"inputToken"}],staticClass:"weui-input",attrs:{type:"text",placeholder:"请输入token"},domProps:{value:t.inputToken},on:{input:function(e){e.target.composing||(t.inputToken=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"weui-btn-area"},[s("a",{staticClass:"weui-btn weui-btn_primary",attrs:{href:"javascript:"},on:{click:t.saveToken}},[t._v("确定")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell"},[e("div",{staticClass:"weui-cell__bd"},[e("p",[this._v("还没有捐款信息，快去新增一个吧")])])])}]};var d=s("VU/8")(_,p,!1,function(t){s("1fqm")},"data-v-2ebfdfbe",null).exports;a.a.use(l.a);var m=new l.a({routes:[{path:"/",name:"live",component:c},{path:"/admin",name:"admin",component:d}]}),h=s("mtWM"),w=s.n(h),f=s("Rf8U"),C=s.n(f);a.a.use(C.a,w.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:m,components:{App:n},template:"<App/>"})},O694:function(t,e){},u1NA:function(t,e,s){t.exports=s.p+"static/img/cover.5814ee5.jpg"}},["NHnr"]);
//# sourceMappingURL=app.b3ab9c70e5ddedcd0e21.js.map